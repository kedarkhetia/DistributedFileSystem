syntax = "proto3";
option java_package = "edu.usfca.cs.dfs.messages";


// Protobuf Wrapper message
message ProtoMessage {
    oneof msg {
        Controller controller = 1;
        Storage storage = 2;
        Client client = 3;
    }
}

// Controller Messages
message Controller {
    oneof msg {
        StorageNode storageNode = 1;
        StorageLocationRequest storageLocationRequest = 2;
        StorageSpace StorageSpace = 3;
    }
}

message StorageNode {
    string host = 1;
    int32 port = 2;
}

message StorageLocationRequest {
    string filename = 1;
    int64 size = 2;
}

message StorageSpace {
	int64 availableSpace = 1;
}

// Storage Messages
message Storage {
    oneof msg {
        StoreChunk storeChunk = 1;
        StorageNodeResponse storeNodeResponse = 2;
        StorageEmptyMessage messageType = 3;
    }
}

message StorageEmptyMessage {
	enum MessageType {
		AVAILABLE_SPACE = 0;
	}
	MessageType messageType = 1;
}

message StorageNodeResponse {
    bool flag = 1;
}

message StoreChunk {
    string fileName = 1;
    int32 chunkId = 2;
    bytes data = 3;
    repeated StorageNode storageLocations = 4;
}

// Client Messages
message Client {
    oneof msg {
        StorageLocationResponse storageLocationResponse = 1;
    }
}

message StorageLocationResponse {
    repeated StorageNode locations = 1;
}


